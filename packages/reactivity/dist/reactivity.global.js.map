{
  "version": 3,
  "sources": ["../src/index.ts", "../../shared/src/index.ts", "../src/effect.ts", "../src/baseHandler.ts", "../src/reactive.ts"],
  "sourcesContent": ["export {reactive} from \"./reactive\";\nexport {effect} from './effect'\n", "\nexport const isObject = (val) => {\n    return val !== null && typeof val === \"object\";\n};\n\nexport const isString = (val) => typeof val === \"string\";\n\nconst camelizeRE = /-(\\w)/g;\n/**\n * @private\n * \u628A\u70E4\u8089\u4E32\u547D\u540D\u65B9\u5F0F\u8F6C\u6362\u6210\u9A7C\u5CF0\u547D\u540D\u65B9\u5F0F\n */\nexport const camelize = (str: string): string => {\n    return str.replace(camelizeRE, (_, c) => (c ? c.toUpperCase() : \"\"));\n};\n\nexport const extend = Object.assign;\n\n// \u5FC5\u987B\u662F on+\u4E00\u4E2A\u5927\u5199\u5B57\u6BCD\u7684\u683C\u5F0F\u5F00\u5934\nexport const isOn = (key) => /^on[A-Z]/.test(key);\n\nexport function hasChanged(value, oldValue) {\n    return !Object.is(value, oldValue);\n}\n\nexport function hasOwn(val, key) {\n    return Object.prototype.hasOwnProperty.call(val, key);\n}\n\n/**\n * @private\n * \u9996\u5B57\u6BCD\u5927\u5199\n */\nexport const capitalize = (str: string) =>\n    str.charAt(0).toUpperCase() + str.slice(1);\n\n/**\n * @private\n * \u6DFB\u52A0 on \u524D\u7F00\uFF0C\u5E76\u4E14\u9996\u5B57\u6BCD\u5927\u5199\n */\nexport const toHandlerKey = (str: string) =>\n    str ? `on${capitalize(str)}` : ``;\n\n// \u7528\u6765\u5339\u914D kebab-case \u7684\u60C5\u51B5\n// \u6BD4\u5982 onTest-event \u53EF\u4EE5\u5339\u914D\u5230 T\n// \u7136\u540E\u53D6\u5230 T \u5728\u524D\u9762\u52A0\u4E00\u4E2A - \u5C31\u53EF\u4EE5\n// \\BT \u5C31\u53EF\u4EE5\u5339\u914D\u5230 T \u524D\u9762\u662F\u5B57\u6BCD\u7684\u4F4D\u7F6E\nconst hyphenateRE = /\\B([A-Z])/g;\n/**\n * @private\n */\nexport const hyphenate = (str: string) =>\n    str.replace(hyphenateRE, \"-$1\").toLowerCase();\n", "let activeEffect = null\nconst targetMap = new WeakMap()\n\nexport class ReactiveEffect {\n    public active = true\n    public deps = []\n    public parent = null\n\n    constructor(public fn, public scheduler) {\n    }\n\n    run() {\n        if (!this.active) return this.fn()\n        try {\n            this.parent = activeEffect\n            activeEffect = this\n            this.fn()\n        } finally {\n            activeEffect = this.parent\n        }\n\n    }\n}\n\nexport const effect = (fn, options: any = {}) => {\n    const _effect = new ReactiveEffect(fn, options.scheduler)\n    _effect.run()\n}\n\nexport const track = (target, key) => {\n    let depsMap = targetMap.get(target)\n    if (!depsMap) {\n        targetMap.set(target, depsMap = new Map)\n    }\n    let deps = depsMap.get(key)\n    if (!deps) {\n        depsMap.set(key, deps = new Set)\n    }\n    trackEffect(deps)\n}\nexport const trackEffect = (deps) => {\n    if (!activeEffect) return\n    if (!deps.has(activeEffect)) {\n        deps.add(activeEffect)\n        activeEffect.deps.push(deps)\n    }\n}\n\nexport const trigger = (target, key) => {\n    const depsMap = targetMap.get(target)\n    if (!depsMap) return\n    const effects = depsMap.get(key)\n    triggerEffect(effects)\n}\nexport const triggerEffect = (effects)=>{\n    const _effects:any = new Set(effects)\n    _effects.forEach(effect => {\n        if(effect !== activeEffect){\n            effect.run()\n        }\n    })\n}\n", "import {track, trigger} from \"./effect\";\n\nexport const enum ReactiveFlags {\n    IS_REACTIVE = '__v_isReactive'\n}\nexport const mutableHandlers = {\n    get(target,key){\n        if(key === ReactiveFlags.IS_REACTIVE){\n            return true\n        }\n        track(target,key)\n        return Reflect.get(target,key)\n    },\n    set(target,key,value) {\n        const oldValue = target[key]\n        const res = Reflect.set(target,key,value)\n        trigger(target,key)\n        return res\n    }\n}\n", "import {isObject} from \"@ls-toy-vue/shared\";\nimport {mutableHandlers, ReactiveFlags} from \"./baseHandler\";\n\n\nconst reactiveMap =  new WeakMap(); // key\u53EA\u80FD\u662F\u5BF9\u8C61\n\nexport function reactive (target){\n\n    if(!isObject(target)){\n        return\n    }\n    const targetFlag = target[ReactiveFlags.IS_REACTIVE]\n    if(targetFlag){\n        return target\n    }\n\n    const existingProxy = reactiveMap.get(target)\n    if(existingProxy) return existingProxy\n\n    const proxy = new Proxy(target,mutableHandlers)\n    reactiveMap.set(target,proxy)\n    return proxy\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACCO,MAAM,WAAW,CAAC,QAAQ;AAC7B,WAAO,QAAQ,QAAQ,OAAO,QAAQ;AAAA,EAC1C;;;ACHA,MAAI,eAAe;AACnB,MAAM,YAAY,oBAAI,QAAQ;AAEvB,MAAM,iBAAN,MAAqB;AAAA,IAKxB,YAAmB,IAAW,WAAW;AAAtB;AAAW;AAJ9B,WAAO,SAAS;AAChB,WAAO,OAAO,CAAC;AACf,WAAO,SAAS;AAAA,IAGhB;AAAA,IAEA,MAAM;AACF,UAAI,CAAC,KAAK;AAAQ,eAAO,KAAK,GAAG;AACjC,UAAI;AACA,aAAK,SAAS;AACd,uBAAe;AACf,aAAK,GAAG;AAAA,MACZ,UAAE;AACE,uBAAe,KAAK;AAAA,MACxB;AAAA,IAEJ;AAAA,EACJ;AAEO,MAAM,SAAS,CAAC,IAAI,UAAe,CAAC,MAAM;AAC7C,UAAM,UAAU,IAAI,eAAe,IAAI,QAAQ,SAAS;AACxD,YAAQ,IAAI;AAAA,EAChB;AAEO,MAAM,QAAQ,CAAC,QAAQ,QAAQ;AAClC,QAAI,UAAU,UAAU,IAAI,MAAM;AAClC,QAAI,CAAC,SAAS;AACV,gBAAU,IAAI,QAAQ,UAAU,oBAAI,KAAG;AAAA,IAC3C;AACA,QAAI,OAAO,QAAQ,IAAI,GAAG;AAC1B,QAAI,CAAC,MAAM;AACP,cAAQ,IAAI,KAAK,OAAO,oBAAI,KAAG;AAAA,IACnC;AACA,gBAAY,IAAI;AAAA,EACpB;AACO,MAAM,cAAc,CAAC,SAAS;AACjC,QAAI,CAAC;AAAc;AACnB,QAAI,CAAC,KAAK,IAAI,YAAY,GAAG;AACzB,WAAK,IAAI,YAAY;AACrB,mBAAa,KAAK,KAAK,IAAI;AAAA,IAC/B;AAAA,EACJ;AAEO,MAAM,UAAU,CAAC,QAAQ,QAAQ;AACpC,UAAM,UAAU,UAAU,IAAI,MAAM;AACpC,QAAI,CAAC;AAAS;AACd,UAAM,UAAU,QAAQ,IAAI,GAAG;AAC/B,kBAAc,OAAO;AAAA,EACzB;AACO,MAAM,gBAAgB,CAAC,YAAU;AACpC,UAAM,WAAe,IAAI,IAAI,OAAO;AACpC,aAAS,QAAQ,CAAAA,YAAU;AACvB,UAAGA,YAAW,cAAa;AACvB,QAAAA,QAAO,IAAI;AAAA,MACf;AAAA,IACJ,CAAC;AAAA,EACL;;;ACxDO,MAAM,kBAAkB;AAAA,IAC3B,IAAI,QAAO,KAAI;AACX,UAAG,QAAQ,oCAA0B;AACjC,eAAO;AAAA,MACX;AACA,YAAM,QAAO,GAAG;AAChB,aAAO,QAAQ,IAAI,QAAO,GAAG;AAAA,IACjC;AAAA,IACA,IAAI,QAAO,KAAI,OAAO;AAClB,YAAM,WAAW,OAAO;AACxB,YAAM,MAAM,QAAQ,IAAI,QAAO,KAAI,KAAK;AACxC,cAAQ,QAAO,GAAG;AAClB,aAAO;AAAA,IACX;AAAA,EACJ;;;ACfA,MAAM,cAAe,oBAAI,QAAQ;AAE1B,WAAS,SAAU,QAAO;AAE7B,QAAG,CAAC,SAAS,MAAM,GAAE;AACjB;AAAA,IACJ;AACA,UAAM,aAAa;AACnB,QAAG,YAAW;AACV,aAAO;AAAA,IACX;AAEA,UAAM,gBAAgB,YAAY,IAAI,MAAM;AAC5C,QAAG;AAAe,aAAO;AAEzB,UAAM,QAAQ,IAAI,MAAM,QAAO,eAAe;AAC9C,gBAAY,IAAI,QAAO,KAAK;AAC5B,WAAO;AAAA,EACX;",
  "names": ["effect"]
}
